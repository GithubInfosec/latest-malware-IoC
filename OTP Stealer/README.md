# Unmasking the SMS Stealer: Targeting Several Countries with Deceptive Apps

## Table of Contents

1. [Introduction](#introduction)
2. [The Journey to Infection](#the-journey-to-infection)
3. [The Scale of the Campaign](#the-scale-of-the-campaign)
4. [MITRE ATT&CK Techniques](#mitre-attck-techniques)
5. [Unmasking the Threat Actors to Understand their Motive](#unmasking-the-threat-actors-to-understand-their-motive)
6. [Conclusion](#conclusion)
7. [Source](#source)

---

## Introduction

- **Report Reference:** [OTPSR01] 
- **Summarized by:** [InfoSec]  
- **Analysis Date:** [2024/7/31]  
- **Report Date:** [2024/7/31]

One-time passwords (OTPs) are designed to add an extra layer of security to online accounts, and most enterprises have become very dependent upon them for controlling access to sensitive data and applications. However, these passwords are just as valuable to attackers. Mobile malware has become increasingly sophisticated, employing cunning tactics to steal these crucial codes and bypass their added protection to enable malicious infiltration to corporate networks and data. 

<p align="center">
  <img src=".img/targeted_countries.png" alt="TargetedCountries">
</p>

---

## The Journey to Infection

Before we dive into the technical details of this sophisticated and dangerous malware campaign, let’s first take a journey into the deceptive lifecycle of how a user/device becomes a target.

<p align="center">
  <img src=".img/infection_journey.png" alt="InfectionJourney">
</p>

1. **Phase 1: App Installation – A Wolf in Sheep’s Clothing**  
   The victim is tricked into sideloading a malicious application either through a deceptive advertisement mimicking a legitimate app store or through the usage of automated Telegram bots communicating directly with the target (see below for more details).

2. **Phase 2: Permission Requests – Gaining Access**  
   Upon installation, the malicious application requests the SMS message read permission. This is a high-risk permission on Android that grants extensive access to sensitive personal data. While legitimate applications may require SMS permissions for specific, well-defined functions, this particular app’s request is intended to exfiltrate the victim’s private text message communications.

3. **Phase 3: Command & Control Server Retrieval – Finding its Puppet Master**  
   The malware then reaches out to its Command and Control (C&C) server. This server acts as the brain of the operations, executing commands and collecting stolen data. Initially, the malware relied on Firebase to retrieve the C&C server address. However, the attackers have adapted their tactics and they now utilize Github repositories or even embed the C&C server address directly within the app itself.

4. **Phase 4: C&C Communication – Checking In & Uploading Data**  
   With the C&C server address secured, the infected device establishes a connection. This communication serves a dual purpose; 1) The malware registers its presence with the server, confirming its operational status, and 2) Establishes a channel to transmit stolen SMS messages, including any valuable OTP codes.

5. **Phase 5: OTP Harvesting – The Silent Interceptor**  
   The final phase transforms the victim’s device into a silent interceptor. The malware remains hidden, constantly monitoring new incoming SMS messages. Its primary target is OTPs used for online account verification.

---

## The Scale of the Campaign

The scale of this malware campaign is staggering. Let’s take a look at some of the numbers our researchers uncovered to truly understand the scale of this campaign:

- **Over 107,000 Unique Malware Applications:** To date, our researchers have found over 107,000 malware samples directly tied to this campaign. This indicates a prolific campaign targeting a vast number of global victims.
- **Over 95% of Malware Samples are Unknown or Unavailable:** Of those 107,000 malware samples, over 99,000 of these applications are/were unknown and unavailable in generally available repositories.
- **Over 60 Top-tier Global Brand Services Targeted:** This malware was monitoring one-time password messages across over 600 global brands, with some brands having user counts in the hundreds of millions of users.
- **113 Countries:** Victims spanned across 113 countries with **Russia** and **India** being the primary targets based on the volume of victims pulled from the samples. We also saw activity from several embargo countries as well.
- **13 Command and Control (C&C) Servers:** Our researchers identified 13 C&C servers used by the malware to steal and leak SMS messages from victim devices.
- **Extensive Telegram Bot Network:** A vast network of roughly 2,600 Telegram bots was linked to this campaign, serving as a distribution channel for some of the malicious applications.

These numbers paint a concerning picture of a large-scale and sophisticated operation behind this malware campaign. The campaign’s ability to evade detection by many AV solutions emphasizes the need for a multi-layered approach to mobile security.

---

## Unmasking the Threat Actors to Understand their Motive

While we cannot say for certain the exact motive behind this campaign, we do know that there was a financial component based on our research. We can see in the screenshot below that the platform accepts various payment methods, including cryptocurrency, a method that is commonly used by cybercriminals to conceal user identity.

During our investigation, our researchers uncovered a crucial link that highlights the financial motive behind this large-scale malware campaign. They discovered a connection between a website, fastsms.su, and one of the malware samples from this campaign. Further investigation revealed a well-developed C&C platform with a user-defined geographic selection model. This platform presented a range of service providers, both well-known consumer and enterprise services, with varying costs based on phone number availability within the chosen country. Upon selecting a service and making a payment, the threat actor received a designated phone number available to the selected and available service. The platform subsequently displays the OTP generated upon successful account setup. 

<p align="center">
  <img src=".img/fastsms.png" alt="Targets">
</p>

---

## MITRE ATT&CK Techniques

To help our customers and the industry understand the impact of this malware, we’ve compiled the MITRE Tactics and Techniques for reference.

| Tactic            | ID         | Name                                        | Description                                                |
|-------------------|------------|---------------------------------------------|------------------------------------------------------------|
| Persistence       | T1624.001  | Event Triggered Execution: Broadcast Receivers | It creates a broadcast receiver to receive SMS events.      |
| Defense Evasion   | T1406.002  | Obfuscated Files or Information: Software Packing | It is using obfuscation and packers to conceal its code.    |
| Collection        | T1517      | Access Notifications                        | It registers a receiver to monitor incoming SMS messages.   |
|                   | T1636.004  | Protected User Data: SMS Messages           | It exfiltrates all the incoming OTP SMS messages.           |
| Command and Control | T1481.003 | Web Service: One-Way Communication           | It sends all the exfiltrated info to a C&C server.          |
| Exfiltration      | T1646      | Exfiltration Over C2 Channel                | It is using HTTPS protocol to exfiltrate data.              |

---

## Conclusion

The proliferation of this mobile malware, coupled with the ease of data theft (e.g., SMS, OTPs), poses a significant threat to individuals and organizations alike. With a vast array of malware samples discovered by our research team and the multiple infection vectors, you can see the threat landscape is complex and constantly evolving. On its own, stealing SMS messages may seem insignificant, but the ability of these malicious applications to steal sensitive information, including one-time passwords (OTPs), underscores the critical need for robust Enterprise mobile security solutions to protect from malicious sites and unknown malware, and provide enterprise visibility into those targeted.

These stolen credentials serve as a springboard for further fraudulent activities, such as creating fake accounts on popular services to launch phishing campaigns or social engineering attacks. Addressing this complex challenge requires a multi-layered approach, encompassing not only advanced detection technologies but also user education and awareness.

---

## Source

- [Unmasking the SMS Stealer: Targeting Several Countries with Deceptive Apps](https://www.zimperium.com/blog/unmasking-the-sms-stealer-targeting-several-countries-with-deceptive-apps/)
