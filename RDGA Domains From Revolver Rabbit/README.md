# RDGAs: The Next Chapter in Domain Generation Algorithms

## Table of Contents
1. [Introduction](#introduction)
2. [What Exactly Are RDGAs?](#what-exactly-are-rdgas)
3. [Why Call It RDGA?](#why-call-it-rdga)
4. [MASSIVE AMOUNTS OF RDGA DOMAINS FROM REVOLVER RABBIT](#MASSIVE-AMOUNTS-OF-RDGA-DOMAINS-FROM-REVOLVER-RABBIT)
4. [Conclusion](#conclusion)
5. [Source](#source)

---

## Introduction

<p align="center">
    <img src=".img/revolver-rabbit.png" alt="mail." />
</p>

This trailblazing report explores a burgeoning technique that threat actors are using to covertly transform the DNS threat landscape with millions of new domains. You’ll learn how traditional malware-based domain generation algorithms (DGAs) have evolved into registered DGAs (RDGAs) that can be used for malware, phishing, spam, scams, gambling, traffic distribution systems (TDS), virtual private networks (VPNs), and more. We’ll unveil a new RDGA threat actor named Revolver Rabbit who’s associated with XLoader malware. We’ll also reveal how the notorious Hancitor malware used an RDGA to generate its C2 domains for years while most of the security industry remained oblivious to their methods.

For nearly two decades, threat actors have used domain generation algorithms (DGAs) to distribute malware. In recent years, threat actors have been employing a technique we call registered domain generation algorithms (RDGAs), in which the actor uses an algorithm to register many domain names at one time. RDGAs are considerably harder to detect and defend against than traditional DGAs, and despite their prevalence on the internet, they have been woefully underreported by the security community. We originally described RDGAs in October 2023 and have published on the topic multiple times since then.

The full report will be available [here](https://github.com/GithubInfosec/malware-ioc-test/blob/9a5d3baabdb00747e10e8650538b65ab7c2d1253/RDGA%20Domains%20From%20Revolver%20Rabbit/infoblox-research-report-registered-dgas-the-prolific-new-menace-no-one-is-talking-about.pdf).

---

## What Exactly Are RDGAs?

RDGAs are a programmatic mechanism that allows threat actors to create many domain names at once, or over time, to register for use in their criminal infrastructure. These differ significantly from the traditional domain generation algorithms (DGAs) that have long been associated with malware. In an RDGA, the algorithm is a secret kept by the threat actor, and they register all the domain names. In a traditional DGA, the malware contains an algorithm that can be discovered and most of the domain names will not be registered.

<p align="center">
    <img src=".img/diff.png" alt="diff." />
</p>

While traditional DGAs are used exclusively for connection to a malware controller, RDGAs can be used for a wide range of purposes including malware, phishing, spam, scams, gambling, traffic distribution systems (TDS), virtual private networks (VPNs), or essentially any activity that benefits from having large numbers of domain names. We’ll cover a couple of interesting cases of RDGA usage for this blog, but there are far more examples in our full research paper.

Threat actors, criminal enterprises, and legitimate businesses all use RDGAs. Registrars like Namecheap even offer tools to generate variants of a chosen domain name, and these tools can be leveraged by anyone — legitimate customers or threat actors.

<p align="center">
    <img src=".img/namecheaps.png" alt="namecheaps." />
</p>

---

## Why Call It RDGA?

We coined this phrase and acronym because the term “DGA” has become broadly overused in the years since the concept was introduced, effectively serving as an umbrella term for any domain that is (or appears to be) algorithmically generated. In the same way that the concept of dictionary DGAs (DDGAs) was introduced to distinguish algorithms that generate domains using real words rather than random characters, we’re using the concept of RDGAs to distinguish algorithms that threat actors use to privately register large numbers of domains from algorithms embedded in publicly-available malware to make their C2 communications more difficult to disrupt.

---

## MASSIVE AMOUNTS OF RDGA DOMAINS FROM REVOLVER RABBIT

The most remarkable example included is an RDGA controlled by the actor Infoblox named Revolver Rabbit. This actor has registered over 500,000 domains costing them over $1 million in registration fees. At the same time, discovering the purpose of these domains was a challenge. Infoblox Threat Intel has been tracking Revolver Rabbit for nearly a year but was stumped for months on the threat actor’s motivation. How can so many domains be registered without a trace of malicious activity? Recently Infoblox solved the puzzle: Revolver Rabbit uses the RDGA to create command and control (C2) and decoy domains for XLoader (aka Formbook) malware. This malware is an information stealer typically delivered via phishing emails. It must be a profitable malware for Revolver Rabbit given their investment in domain names. Connecting the Revolver Rabbit RDGA to an established malware after months of tracking highlights the importance of understanding RDGAs as a technique within the threat actor’s toolbox.

<p align="center">
    <img src=".img/redirects.jpg" alt="redirects." />
</p>

- We discovered 1.5M+ RDGA domains (6K+ newly-registered daily) associated with Revolver Rabbit. 
- Revolver Rabbit predominantly uses .bond TLDs, but we also found use of .com and .click TLDs.
- We also discovered Revolver Rabbit is monetizing through cash parking.
- Cash parking is a method of earning money through advertisements from parked pages of registered domains.
- In this case, we find redirects to these parked pages, which contain affiliate marketing links.

<p align="center">
    <img src=".img/affiliate marketing link.jpg" alt="markst." />
</p>

---

## Conclusion

RDGA domains are associated with a panoply of dubious activities that most organizations don’t want on their networks. But despite being used to register millions of new domains, RDGAs have gone almost entirely unrecognized by the security industry. This lack of reporting is likely due to the fact that RDGA detection requires both significant DNS expertise and access to large volumes of DNS data. Organizations should be aware of the threat that RDGAs pose to their networks and should implement security solutions that include automated RDGA detection.

<p align="center">
    <img src=".img/RDGA Domains.jpg" alt="rating." />
</p>

---

## Source

- [LinkedIn Post on Revolver Rabbit](https://www.linkedin.com/posts/unit42_rdga-revolverrabbit-xloader-activity-7242980352632242176-hwN5/)
- [Unit42 Twitter Post](https://x.com/Unit42_Intel/status/1837214713639293061)
- [Infoblox Blog on RDGAs](https://blogs.infoblox.com/threat-intelligence/rdgas-the-next-chapter-in-domain-generation-algorithms/)
- [BleepingComputer Article on Revolver Rabbit](https://www.bleepingcomputer.com/news/security/revolver-rabbit-gang-registers-500-000-domains-for-malware-campaigns/)
- [Cybervergent Article on the Revolver Rabbit Saga](https://www.cybervergent.com/articles/the-revolver-rabbit-saga)
