# BlankBot: A New Android Banking Trojan with Screen Recording, Keylogging, and Remote Control Capabilities

## Table of Contents
1. [Introduction](#introduction)
2. [Key Points](#key-points)
3. [Overview](#overview)
4. [Technical Analysis](#technical-analysis)
   1. [Screen Recording](#screen-recording)
   2. [Keylogging](#keylogging)
   3. [Injections](#injections)
5. [Commands](#commands)
6. [Conclusion](#conclusion)
7. [Source](#source)

---

## Introduction

- **Report Reference:** [BLANKBR01] 
- **Summarized by:** [InfoSec]  
- **Analysis Date:** [2024/8/16]  
- **Report Date:** [2024/8/01]

<p align="center">
    <img src=".img/entry.png" alt="BlankBot - a new Android banking trojan with screen recording, keylogging and remote control capabilities " />
</p>

---

## Key Points
- In July 2024, Intel 471 Malware Intelligence researchers discovered the new BlankBot Android banking trojan.
- Based on the application names and certain strings found within the application, it is highly likely BlankBot’s primary targets are Turkish users.
- BlankBot features a range of malicious capabilities, which include customer injections, keylogging, screen recording, and it communicates with a control server over a WebSocket connection.
- At the time of this report, most samples remain largely undetected by the majority of antivirus software, according to VirusTotal service.
- The malware apparently still is under development, as indicated by the presence of logs and code variants.

---

## Overview
On July 24, 2024, Intel 471 Malware Intelligence researchers discovered malicious Android samples that impersonated utility applications which could not be attributed to any known existing malware family. We named it BlankBot since there was no reference via open sources at the time of this report.

The first BlankBot samples were from the end of June 2024 and almost all were undetected by most antivirus software.

<p align="center">
    <img src=".img/1.png" alt="The image depicts a screenshot of Android package kit (APK) icons BlankBot malware used, which we captured July 29, 2024. " />
</p>

Like many other Android banking trojans, BlankBot also abuses accessibility services to obtain complete control of infected devices. In particular, the malware is able to log everything that appears on the infected device, including short message service (SMS) text, sensitive information, and a list of applications used. The malware also is able to conduct custom injections used to steal bank information, such as payment card data and a lock pattern for the device.

Communications between BlankBot and a controller start with a “GET” request where the hypertext transfer protocol (HTTP) headers include information about the infected device, such as the battery level, screen size, model, manufacturer, and operating system (OS) version. The malware uses port 8080 via a WebSocket connection for subsequent controller communication.

At this early stage, application names and certain strings found within the application suggest it is likely the primary BlankBot targets are Turkish users. However, no specific financial institutions were identified as targets during our analysis, therefore, this malware could be distributed in campaigns against users in different countries.

---

## Technical Analysis
The malicious app is installed, the icon is not displayed on the device launcher, and the user is prompted to grant accessibility permissions accompanied by an explanation message.

“Welcome! App needs Accessibility permission to run properly. Please give accessibility permission!”

<p align="center">
    <img src=".img/2.png" alt="The image depicts a screenshot of the BlankBot installation process, which we captured July 29, 2024. " />
</p>

The malware subsequently initiates communication with the control server by sending an HTTP “GET” request to the controller and switches to the WebSocket network connection protocol.

Once the accessibility service access is granted, BlankBot displays a black screen to the user, which indicates that the app is updating. However, the malware automatically obtains all necessary permissions in the background.

<p align="center">
    <img src=".img/3.png" alt="The image depicts a screenshot of a fake update screen and permissions BlankBot obtained automatically, which we captured July 29, 2024. " />
</p>

If the malware is installed on a device with Android 13 or newer, BlankBot implements a session-based package installer to bypass the restricted settings feature implemented in Android 13. The bot asks the victim to allow installing applications from third-party sources, then it retrieves the Android package kit (APK) file stored inside the application assets directory with no encryption and proceeds with the package installation process.

<p align="center">
    <img src=".img/4.png" alt="The image depicts a screenshot of the BlankBot payload installation phase via Android 13, which we captured July 29, 2024. " />
</p>

---

### Screen Recording
The malware can perform screen recording using Android's MediaProjection and MediaRecorder application programming interfaces (APIs). BlankBot is able to capture a video of the device screen via the MediaProjection API, and the content is saved as a moving pictures experts group (MP4) file within the application's internal storage. However, this feature apparently still is under development since the implementation changes in different samples.

BlankBot uses the MediaRecorder API to capture screen images after specifying the height and width of the infected device, the image format, and the maximum number of images to be acquired. The joint photographic experts group (JPEG) images captured are Base64 encoded and sent to the remote server.

---

### Keylogging
Like many other Android banking trojans, the use of accessibility services plays a key role in intercepting and stealing confidential information. BlankBot also abuses accessibility to retrieve data from the infected devices, such as a list of applications used, notifications, text the user types, and other sensitive information that appears on the screen or the victim copies and pastes.

<p align="center">
    <img src=".img/keylogging.png" alt="Keylogger" />
</p>

However, BlankBot uses a unique custom virtual keyboard implemented via the “InputMethodService” class that Android provides, unlike most other malware. The primary purpose of this code is to intercept and send keys the user presses on the keyboard.

---

### Injections
Upon a specific command received from the command-and-control (C2) server, the bot is able to create a customizable overlay based on the threat actors’ needs. The overlay could be abused to ask for banking credentials, personal information, payment card data, or to steal the lock pattern. The malware developers included two external, open-source libraries to implement the custom injection templates, specifically:

- The CompactCreditInput library at https://github.com/10bis/CompactCreditInput is used to create a view to steal payment card data, automatically validate data and manage the card type logo based on the number entered.
- The Pattern Locker View library at https://github.com/l7naive/pattern-lock is used to create a pattern lock view.

We simulated the control server functionality to trigger and test a wide variety of BlankBot capabilities, which include overlays. We issued a command to create three different views customized with the ING bank logo and user interface (UI) text elements displayed. Any user input was logged and promptly exfiltrated to the control server.

<p align="center">
    <img src=".img/5.png" alt="The image depicts a screenshot of customized overlays that our Malware Intelligence Team generated, which we captured July 30, 2024. " />
</p>

---

## Commands
BlankBot communicates with the C2 server over a WebSocket connection to exfiltrate data and receive a wide range of bot commands. Specifically, the botmaster is able to start and stop screen recording to receive a live view of the infected device display. For applications that implement a “FLAG_SECURE” security measure to prevent sensitive data leak, the botmaster can leverage a hidden virtual network (HVNC) module to exfiltrate the layout of UI elements by abusing the accessibility services. Threat actors are able to perform on-device fraud (ODF) by waking up and controlling the device remotely with different types of supported gestures, such as clicks or swipes. Additionally, BlankBot is capable of creating overlays, as described in the previous section, as well as collecting contacts, SMS text, and a list of installed applications. The commands supported by the bot were described in the table below.

| **Command ID** | **Description**                                    |
|----------------|----------------------------------------------------|
| -3             | Stop HVNC module                                   |
| -1             | Stop screen recording                              |
| 1              | Start screen recording                             |
| 2              | Perform a gesture                                  |
| 3              | Start HVNC module                                  |
| 11             | Create an overlay with message                     |
| 12             | Request a permission or change device settings     |
| 13             | Collect SMS text                                   |
| 15             | Collect contacts                                   |
| 16             | Send text message                                  |
| 18             | Wake up device                                     |
| 20             | Collect installed applications                     |
| 22             | Create an overlay with edit text or pattern        |
| 24             | Delete an SMS text                                 |
| 25             | Uninstall an application                           |
| 26             | Launch an application                              |
| 27             | Create an overlay for payment card data            |

---

## Conclusion
BlankBot is a new Android banking trojan still under development, as evidenced by the multiple code variants observed in different applications. Regardless, the malware can perform malicious actions once it infects an Android device, which include conducting custom injection attacks, ODF or stealing sensitive data such as credentials, contacts, notifications, and SMS messages.

This research aims to demonstrate how the mobile threat landscape continually evolves and how cybercriminals continue to create new types of malware to stay under the radar until receiving media attention or interest from most antivirus companies.

---

## Source
[BlankBot: A New Android Banking Trojan with Screen Recording, Keylogging, and Remote Control Capabilities](https://intel471.com/blog/blankbot-a-new-android-banking-trojan-with-screen-recording-keylogging-and-remote-control-capabilities)
