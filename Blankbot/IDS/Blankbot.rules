alert http $HOME_NET any -> $EXTERNAL_NET any (
msg:"ET INFO Android Device Connectivity Check"; 
flow:established,to_server; 
urilen:13; 
http.method; content:"GET"; 
http.uri; content:"/generate_204"; fast_pattern; endswith; 
http.host; content:"connectivitycheck.gstatic.com"; 
http.accept_enc; content:"gzip"; depth:4; endswith; 
http.header_names; content:!"Cache"; content:!"Referer"; 
classtype:misc-activity; 
sid:2036220; rev:4; 
metadata:affected_product Android, attack_target Mobile_Client, created_at 2018_09_14, deployment Perimeter, deployment Internal, performance_impact Low, signature_severity Informational, tag Connectivity_Check, updated_at 2023_05_01;
)

alert tcp any any -> any $HTTP_PORTS ( 
msg:"POLICY-OTHER HTTP request by IPv4 address attempt"; 
flow:to_server,established; 
http_header; content:"Host:",fast_pattern,nocase; 
pcre:"/^Host\x3a\s*(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])\s*:?\s*\d*\s*$/ims"; 
service:http; 
reference:url,www.w3.org/Protocols/rfc2616/rfc2616-sec15.html; 
classtype:policy-violation; 
sid:50447; rev:1; 
)
