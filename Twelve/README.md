<div align="center">

# -=TWELVE=- is back

</div>


## Table of Contents
1. [Introduction](#introduction)
2. [About Twelve](#about-twelve)
3. [Unified Kill Chain: In](#unified-kill-chain-in)
4. [Unified Kill Chain: Through](#unified-kill-chain-through)
5. [Unified Kill Chain: Out](#unified-kill-chain-out)
6. [Ransomware](#ransomware)
7. [Wipers](#wipers)
8. [Objectives](#objectives)
9. [Takeaways](#takeaways)
10. [Source](#source)
---

## Introduction

In the spring of 2024, posts with real people’s personal data began appearing on the -=TWELVE=- Telegram channel. Soon it was blocked for falling foul of the Telegram terms of service. The group stayed off the radar for several months, but as we investigated a late June 2024 attack, we found that it employed techniques identical to those of Twelve and relied on C2 servers linked to the threat actor. We are therefore confident that the group is still active and will probably soon resurface. This article uses the Unified Kill Chain methodology to analyze the attackers’ actions.

<p align="center">
    <img src=".img/twelve.png" alt="entry." />
</p>

---

## About Twelve

The group was formed in April 2023 in the context of the Russian-Ukrainian conflict and has attacked Russian government organizations ever since.

The threat actor specializes in encrypting and then deleting victims’ data, which seriously complicates efforts to recover the IT environment. This suggests that their main goal is inflicting as much damage as possible. When attacking, the group aims to reach critical assets, but they do not always succeed. In addition, Twelve exfiltrates sensitive information from its victims’ systems and posts it on its Telegram channel.

Interestingly, Twelve shares infrastructure, utilities, and techniques (TTPs) with the DARKSTAR ransomware group, formerly known as Shadow or COMET, which suggests that the two belong to the same syndicate or activity cluster. At the same time, whereas Twelve’s actions are clearly hacktivist in nature, DARKSTAR sticks to the classic double extortion pattern. This variation of objectives within the syndicate underscores the complexity and diversity of modern cyberthreats.

---

## Unified Kill Chain: In

The In stage in terms of the Unified Kill Chain refers to the initial phases of a cyberattack aimed at gaining access to the target organization’s LAN. These phases include a range of tactical actions: from external reconnaissance to assuming control of the systems inside the protected network.

In most of the attacks we are aware of, the adversary gained initial access to victims’ infrastructure through valid local or domain accounts, VPN or SSH certificates. After gaining access to the victim’s infrastructure, the attackers used the Remote Desktop Protocol (RDP) to move laterally.

Most times, the attackers penetrated the target infrastructure via some of the victim’s contractors. To do this, they gained access to the contractor’s infrastructure and then used its certificate to connect to its customer’s VPN. Having obtained access to that, the adversary can connect to the customer’s systems via the Remote Desktop Protocol (RDP) and then penetrate the customer’s infrastructure.

<p align="center">
    <img src=".img/initialaccess.png" alt="infra." />
</p>

---

## Unified Kill Chain: Through

The Through stage in terms of the Unified Cyber​ Kill Chain refers to adversary actions within a previously compromised target network aimed at gaining access to further systems and data that the attacker needs to achieve their goals. This stage involves a series of steps designed to propagate across the network and access critical assets.

The adversary used ngrok to tunnel traffic. They installed that utility immediately after connecting to the system, and set port 3389 (standard RDP port) in the configuration file. After that, all illegitimate connections to the system via RDP were made through ngrok.

<p align="center">
    <img src=".img/through.png" alt="through." />
</p>

---

## Unified Kill Chain: Out

The Exit stage in terms of the Unified Kill Chain describes the adversary’s concluding actions after successfully infiltrating the target network and gaining access to all systems and data they are looking to access. This stage focuses on achieving the ultimate goals of the attack, which may include data theft, sabotage, or other actions that compromise the confidentiality, integrity, and availability (CIA) of the victim’s information assets.

The adversary uploaded archives containing data they were interested in to `https://dropmefiles.net/` via a browser. We learned that DropMeFiles was the file sharing service they used when we found a page header that read, “Завантаження вдалося! – dropmefiles.net” (“Upload successful!” – dropmefiles.net) in the browser cache in the aftermath of an attack.

<p align="center">
    <img src=".img/exfiltration.png" alt="exfiltration." />
</p>

---

## Ransomware

The attackers used a version of the popular LockBit 3.0 ransomware, compiled from publicly available source code, to encrypt the data.

<p align="center">
    <img src=".img/ransomware.png" alt="ransomware." />
</p>

We detected ransomware files at the following paths:

- `\ProgramData\`
- `\\netlogon\`

The following file names featured in known incidents involving LockBit 3.0 ransomware:

- `twelve.exe`
- `1.exe`
- `12.exe`
- `enc.exe`
- `betta.exe`
- `sed.exe`
- `svo.exe`

Below is a detonation graph for the ransomware, built by Kaspersky Cloud Sandbox. It displays file execution and suspicious events that occur in the process. As you can see from the graph, the ransomware is quite noisy and generates a lot of events that give away its activity.

<p align="center">
    <img src=".img/sandbox.png" alt="sandbox." />
</p>

As previously mentioned under Execution, the ransomware leverages group policies to spread across its victims’ infrastructures. The attackers used PowerShell to move the ransomware file to the netlogon network share and then ran a script to modify group policies.

`powershell.exe -ex bypass -f C:\Users\Public\gpo.ps1`

After updating the policies, they set up scheduled tasks on all domain computers to copy and run the ransomware.

<p align="center">
    <img src=".img/encrypted.png" alt="encrypted." />
</p>

First, the ransomware was moved from the netlogon network share to the local ProgramData directory by the Copywiper task as follows:

`powershell.exe Copy-Item \\[DOMAIN]\netlogon\twelve.exe -Destination C:\ProgramData`

After this, they started the ransomware from a local folder or network share via the CLI, specifying a unique password as the -pass argument:

`cmd.exe /c c:\programdata\twelve.exe -pass ************`

The ransomware algorithm depends on the built-in configuration file. 

We also found that in some cases, attackers used a Trojan made from a leaked builder for the Chaos ransomware to encrypt files. We discovered samples of that ransomware at the following paths:

`c:\netlogon\enc.exe`
`c:\Users\User\enc.exe`
`c:\Windows\System32\config\systemprofile\appdata\roaming\twelve.exe`
`c:\Windows\sysvol\domain\scripts\enc.exe`

As you can see from the screenshot below, the Kaspersky Threat Attribution Engine detects that one of these samples bears 60% similarity to Chaos.

<p align="center">
    <img src=".img/chaos.png" alt="chaos." />
</p>

At the time we discovered the samples, it was unclear who was behind the incidents in which they were used. However, static analysis showed that the code contained characteristic lines linking the samples to the Twelve group.

<p align="center">
    <img src=".img/last.png" alt="last." />
</p>

---

## Wipers

In addition to the ransomware, the adversary used wipers to destroy their victims’ infrastructures. They typically ran the wipers after encrypting files.

The wiper file we found had been compiled from publicly available source code. The wiper rewrites the master boot record (MBR) on connected drives so when the victim next turns on the device, the “From Iran with love – Shamoon” message appears on the screen, and the operating system will not load.

The file then recursively goes through each directory, except for Windows and System Volume Information, on all mounted drives, and does the following for each file:

- Overwrite the file contents with randomly generated bytes;
- Overwrite file metadata: reset size and set random created/modified/opened dates;
- Assign a random name to the file and delete it.

When done, the malicious file deletes itself and shuts down the system.

As we conducted our dynamic and static analyses, we concluded that the wiper version was identical to the publicly available one.

<p align="center">
    <img src=".img/wipers.png" alt="wipers." />
</p>

---

## Objectives

The threat actor’s strategic goals:

1. Destroy critical assets and disrupt business;
2. Steal sensitive data;
3. Discredit victims by reporting the compromise on the attackers’ Telegram channel.

---

## Takeaways

Twelve is mainly driven by hacktivism rather than financial gain. This shows in their modus operandi: rather than demand a ransom for decrypting data, Twelve prefers to encrypt victims’ data and then destroy their infrastructure with a wiper to prevent recovery. The approach is indicative of a desire to cause maximum damage to target organizations without deriving direct financial benefit.

Our analysis also shows that the group sticks to a publicly available and familiar arsenal of malware tools, which suggests it makes none of its own. This makes it possible to detect and prevent Twelve’s attacks in due time. Failure to do so could result in the organization’s infrastructure sustaining significant damage from the threat actor.

---

## Source

[-=TWELVE=- is back](https://securelist.com/twelve-group-unified-kill-chain/113877/)
