# ShadowRoot Ransomware - Malware Analysis Report

## Table of Contents
1. [Introduction](#introduction)
2. [Packer and Obfuscation](#packer-and-obfuscation)
3. [Malware Action and Performance](#malware-action-and-performance)
4. [Conclusion](#conclusion)
5. [Source](#source)

---

## Introduction

- **Report Reference:** [SRR01] 
- **Summarized by:** [InfoSec]  
- **Analysis Date:** [2024/7/12]  
- **Report Date:** [2024/7/12]

This report provides an analysis of the ShadowRoot ransomware targeting **Turkish** businesses. All the features of the malware are listed below:

- PDF attachment with malicious links distributed via emails.
- Download of executable payload from compromised GitHub account.
- PowerShell execution to run hidden processes.
- File encryption with **".shadowroot"** extension.
- Deployment of Turkish ransom notes **("readme.txt")** on desktops.

<p align="center">
    <img src=".img/turkish-ransomware-i-1.webp" alt="PDF attachment">
</p>

---

## Packer and Obfuscation

- The PDF contains a URL link, which downloads further exe payload from a compromised GitHub account. **hxxps://raw[.]githubusercontent[.]com/kurumsaltahsilat/detayfatura/main/PDF.FaturaDetay_202407.exe**
- Initially distributed as **PDF.FaturaDetay_202407.exe**, compiled as a 32-bit binary using Borland Delphi 4.0.
- Second stage executable, **RootDesign.exe**, is protected using dotnet confuser core ver 1.6, an open-source protector for .NET applications.
- Function names and class identifiers are obfuscated with special characters, aiming to evade traditional security detection methods.


<p align="center">
    <img src=".img/turkish-ransomware-i-5.webp" alt="Encrypted files with ShadowRoot extension">
</p>

---

## Malware Action and Performance

- Targets **Turkish** businesses through phishing emails containing fake invoice PDF attachments.
- Downloads and executes a secondary executable via embedded links within the PDF upon user interaction.
- RootDesign.exe executes in hidden mode using a hidden PowerShell command, spawning recursive threads with new PIDs in memory.
- Encrypts non-PE and office files, appending **".ShadowRoot"** extension and dropping multiple encrypted copies on the root.
- Establishes SMTP C2 connection to smtp.mail.ru on port 587, sending details to suspicious email accounts such as **kurumsal[.]tasilat@internet[.]ru**.
- Displays ransom notes in Turkish requesting victims to contact via email for payment instructions, leveraging cryptocurrency for transactions.


<p align="center">
    <img src=".img/turkish-ransomware-i-7.webp" alt="Readme.txt">
</p>

---

## Conclusion

This ransomware seems to be targeting **Turkish** businesses by sending suspicious fake PDF invoices and urging users to click on malicious links. It downloads suspicious Delphi payload and then drops dotnet confuser protected binary for further activity. It encrypts files with “.ShadowRoot” extension and connects to a Russian SMTP mail server. This ransomware appears to a relatively rudimentary, likely the work of an inexperienced developer, exhibiting some basic functionality.

---

## Source

[Forcepoint Blog - ShadowRoot Ransomware Targeting Turkish Businesses](https://www.forcepoint.com/blog/x-labs/shadowroot-ransomware-targeting-turkish-businesses)
